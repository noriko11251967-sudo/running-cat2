<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>é»’çŒ«ãƒ©ãƒ³ãƒŠãƒ¼ãƒ»ã‚¯ãƒªãƒƒã‚¯ã‚²ãƒ¼ãƒ </title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: #ffffff; /* èƒŒæ™¯è‰²ã€‚ãƒ”ãƒ³ã‚¯ã«æˆ»ã™ãªã‚‰ #fde7ed ãªã©ã« */
      height: 100vh;
      overflow: hidden;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      color: #222;
      display: flex;
      flex-direction: column;
    }
    header {
      text-align: center;
      padding: 10px 8px;
      border-bottom: 1px solid #eee;
    }
    h1 { margin: 0 0 6px; font-size: 18px; }
    #score, #timer { margin: 0; font-size: 16px; }

    /* ãƒ—ãƒ¬ã‚¤ã‚¨ãƒªã‚¢ */
    #stage {
      position: relative;
      flex: 1;
      overflow: hidden;
      touch-action: manipulation;
    }

    /* çŒ«ï¼ˆ2ã‚³ãƒåˆ‡ã‚Šæ›¿ãˆç”¨ã® <img> ã‚’1æšã ã‘ä½¿ã†ï¼‰ */
    #cat {
      position: absolute;
      width: 400px;             /* å¤§ãã•ã¯ãŠå¥½ã¿ã§ */
      left: -220px;             /* ç”»é¢å¤–ã‚¹ã‚¿ãƒ¼ãƒˆ */
      top: 50%;
      transform: translateY(-50%);
      user-select: none;
      -webkit-user-drag: none;
      transition: left 2.5s linear; /* æ¨ªç§»å‹•ã®ç§’æ•° */
      cursor: pointer;
    }

    /* å·¦å³åè»¢ï¼ˆå‘ãï¼‰ */
    .flip { transform: translateY(-50%) scaleX(-1); }

    /* çµ‚äº†ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
    #over {
      position: absolute; inset: 0;
      display: none;
      align-items: center; justify-content: center;
      background: rgba(255,255,255,.65);
      font-size: 28px; font-weight: 700;
      text-align: center;
    }
    #over.show { display: flex; }

    /* ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ãƒ—ãƒæ¼”å‡º */
    .pop { animation: pop .15s ease-out; }
    @keyframes pop {
      0% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.08); }
      100% { transform: translateY(-50%) scale(1); }
    }
    .flip.pop { animation: popFlip .15s ease-out; }
    @keyframes popFlip {
      0% { transform: translateY(-50%) scaleX(-1) scale(1); }
      50% { transform: translateY(-50%) scaleX(-1) scale(1.08); }
      100% { transform: translateY(-50%) scaleX(-1) scale(1); }
    }
  </style>
</head>
<body>
  <header>
    <h1>é»’çŒ«ãƒ©ãƒ³ãƒŠãƒ¼ãƒ»ã‚¯ãƒªãƒƒã‚¯ã‚²ãƒ¼ãƒ  ğŸˆâ€â¬›</h1>
    <p id="score">ã‚¹ã‚³ã‚¢: 0</p>
    <p id="timer">æ®‹ã‚Šæ™‚é–“: 15ç§’</p>
  </header>

  <div id="stage">
    <img id="cat" src="cat1.png" alt="cat">
    <div id="over">ã‚²ãƒ¼ãƒ çµ‚äº†ï¼<br>ã‚‚ã†ä¸€åº¦ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã­</div>
  </div>

  <script>
    /* å¿…è¦ãƒ•ã‚¡ã‚¤ãƒ«ï¼šcat1.pngï¼ˆãƒãƒ¼ã‚º1ï¼‰, cat2.pngï¼ˆãƒãƒ¼ã‚º2ï¼‰
       â€» ç”»åƒã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‘ããŒã€Œå·¦å‘ãã€ã®å‰æã§åˆ¶å¾¡ã—ã¦ã„ã¾ã™ã€‚
       ã‚‚ã—å…ƒç”»åƒãŒå³å‘ããªã‚‰ã€ä¸‹ã® scaleX ã®å‰²ã‚Šå½“ã¦ã‚’é€†ã«ã—ã¦ãã ã•ã„ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå‚ç…§ï¼‰ã€‚ */

    const cat = document.getElementById("cat");
    const scoreEl = document.getElementById("score");
    const timerEl = document.getElementById("timer");
    const over = document.getElementById("over");
    const stage = document.getElementById("stage");

    let score = 0;
    let time = 15;
    let playing = true;

    // === èµ°ã£ã¦ã‚‹è¦‹ãˆæ–¹ï¼ˆ2ã‚³ãƒåˆ‡ã‚Šæ›¿ãˆï¼‰ ===
    const frames = ["cat1.png", "cat2.png"];
    let f = 0;
    const frameInterval = setInterval(() => {
      if (!playing) return;
      f = (f + 1) % frames.length;
      cat.src = frames[f];
    }, 150); // åˆ‡ã‚Šæ›¿ãˆé€Ÿåº¦ï¼ˆmsï¼‰

    // === å·¦å³å¾€å¾©ç§»å‹•ï¼ˆé«˜ã•ãƒ©ãƒ³ãƒ€ãƒ ï¼‰ ===
    let goingRight = true; // å·¦â†’å³â†’å·¦â†’â€¦ã¨äº¤äº’
    function runOnce() {
      if (!playing) return;

      const W = stage.clientWidth;
      const H = stage.clientHeight;
      // ä¸Šä¸‹ã®ä½™ç™½ã‚’ç¢ºä¿ï¼ˆç”»åƒé«˜ã•ã‚’åŠ å‘³ã—ã¦ã‚¯ãƒªãƒƒã‚¯ã—ã‚„ã™ã„å¸¯ã«ï¼‰
      const minY = 40, maxY = Math.max(60, H - 160);
      const y = Math.floor(Math.random() * (maxY - minY)) + minY;

      if (goingRight) {
        // å·¦â†’å³
        cat.style.transition = "none";
        cat.style.left = "-220px";
        cat.style.top = y + "px";
        // å…ƒç”»åƒãŒå·¦å‘ãã®å ´åˆã€å³ã¸èµ°ã‚‹æ™‚ã¯åè»¢ã—ã¦å³å‘ãã«ï¼š
        cat.classList.add("flip"); // â† å³å‘ãï¼ˆå…ƒãŒå·¦å‘ãå‰æï¼‰
        // ã‚‚ã—å…ƒç”»åƒãŒå³å‘ããªã‚‰ã€â†‘ã‚’ cat.classList.remove("flip") ã«å¤‰æ›´

        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            cat.style.transition = "left 2.5s linear";
            cat.style.left = W + "px";
          });
        });
      } else {
        // å³â†’å·¦
        cat.style.transition = "none";
        cat.style.left = W + "px";
        cat.style.top = y + "px";
        // å·¦ã¸èµ°ã‚‹æ™‚ã¯å·¦å‘ãï¼ˆå…ƒãŒå·¦å‘ãå‰æãªã®ã§åè»¢ãªã—ï¼‰ï¼š
        cat.classList.remove("flip"); // â† å·¦å‘ãï¼ˆå…ƒãŒå·¦å‘ãå‰æï¼‰
        // ã‚‚ã—å…ƒç”»åƒãŒå³å‘ããªã‚‰ã€â†‘ã‚’ cat.classList.add("flip") ã«å¤‰æ›´

        requestAnimationFrame(() => {
          requestAnimationFrame(() => {
            cat.style.transition = "left 2.5s linear";
            cat.style.left = "-220px";
          });
        });
      }

      goingRight = !goingRight;

      // èµ°ã‚Šåˆ‡ã£ãŸã‚‰1ç§’ä¼‘æ†©ã—ã¦æ¬¡
      // ï¼ˆ2.5ç§’ç§»å‹• + 1ç§’ä¼‘æ†© = 3.5ç§’å‘¨æœŸï¼‰
      setTimeout(() => { if (playing) runOnce(); }, 3500);
    }

    // === ã‚¯ãƒªãƒƒã‚¯ã§ã‚¹ã‚³ã‚¢ ===
    cat.addEventListener("click", () => {
      if (!playing) return;
      score++;
      scoreEl.textContent = "ã‚¹ã‚³ã‚¢: " + score;
      // ã¡ã‚‡ã„æ¼”å‡º
      cat.classList.remove("pop"); cat.classList.remove("flipPop");
      // flipçŠ¶æ…‹ã‹ã©ã†ã‹ã§åˆ¥ã‚¢ãƒ‹ãƒ¡é©ç”¨
      if (cat.classList.contains("flip")) {
        cat.classList.add("pop");
      } else {
        cat.classList.add("pop");
      }
      // ã‚¯ãƒ©ã‚¹ã¯çŸ­æ™‚é–“ã§è‡ªå‹•ã«æˆ»ã‚‹ï¼ˆCSSã®keyframesã§OKï¼‰
    }, { passive: true });

    // === ã‚¿ã‚¤ãƒãƒ¼ ===
    const countdown = setInterval(() => {
      time--;
      timerEl.textContent = "æ®‹ã‚Šæ™‚é–“: " + Math.max(0, time) + "ç§’";
      if (time <= 0) {
        clearInterval(countdown);
        playing = false;
        over.classList.add("show");
      }
    }, 1000);

    // åˆå›ã‚¹ã‚¿ãƒ¼ãƒˆ
    window.addEventListener("load", () => {
      runOnce();
    });

    // ç”»é¢ã‚µã‚¤ã‚ºãŒå¤‰ã‚ã£ãŸæ™‚ã‚‚ã¯ã¿å‡ºã—ã«ãã
    window.addEventListener("resize", () => {
      // æ¬¡ã® runOnce ã§ä½ç½®ã‚’å–ã‚Šç›´ã™ã®ã§ç‰¹åˆ¥å‡¦ç†ã¯ä¸è¦
    });
  </script>
</body>
</html>
